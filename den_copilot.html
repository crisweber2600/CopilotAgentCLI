<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=fediverse:creator content="@localden@mastodon.social"><meta name=theme-color content="rgb(255,255,255)"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Using GitHub Copilot From Inside GitHub Actions &#183; Den Delimarsky</title><meta name=title content="Using GitHub Copilot From Inside GitHub Actions &#183; Den Delimarsky"><meta name=description content="A little experiment in using GitHub Copilot REST APIs inside GitHub Actions to avoid manually parsing text bodies."><link rel=canonical href=https://den.dev/blog/github-copilot-inside-github-actions/><link type=text/css rel=stylesheet href=/css/main.bundle.min.6187f72673aa157b3239be663d046d0fb5cdef9a9bd4ebe87dec72e9fb1be6f93c87e2389009f3a0179dffdd373cc06ab4be9f8d218d090b7f255da3f7d77fff.css integrity="sha512-YYf3JnOqFXsyOb5mPQRtD7XN75qb1Ovofexy6fsb5vk8h+I4kAnzoBed/903PMBqtL6fjSGNCQt/JV2j99d//w=="><script src=https://cdn.jsdelivr.net/gh/Blogger-Peer-Review/quotebacks@1/quoteback.js defer></script>
<script type=text/javascript src=/js/appearance.min.c6198a5ecbc6c7b35a8568d29315f50cf5d775d4461c515a476359767f1a745c245aa83fa96b0c7d83da976cf77481e1fc29537a2391a53ffe69a991638802e6.js integrity="sha512-xhmKXsvGx7NahWjSkxX1DPXXddRGHFFaR2NZdn8adFwkWqg/qWsMfYPal2z3dIHh/ClTeiORpT/+aamRY4gC5g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.6d78c827ca7bcbf72056dbf698bf9aeb759a08966686187deb23f5949f73eca5f39b461284900cdfc08e2976d99eb80a8663648de778ba2a83e633ae16dbfc25.js integrity="sha512-bXjIJ8p7y/cgVtv2mL+a63WaCJZmhhh96yP1lJ9z7KXzm0YShJAM38COKXbZnrgKhmNkjed4uiqD5jOuFtv8JQ==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=https://assets.den.dev/images/icon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://assets.den.dev/images/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://assets.den.dev/images/icon/favicon-16x16.png><link rel=manifest href=https://assets.den.dev/images/icon/site.webmanifest><link rel=mask-icon href=https://assets.den.dev/images/icon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta property="og:title" content="Using GitHub Copilot From Inside GitHub Actions &#183; Den Delimarsky"><meta property="og:description" content="A little experiment in using GitHub Copilot REST APIs inside GitHub Actions to avoid manually parsing text bodies."><meta property="og:type" content="article"><meta property="og:url" content="https://den.dev/blog/github-copilot-inside-github-actions/"><meta property="og:image" content="https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/header.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/header.webp"><meta name=twitter:title content="Using GitHub Copilot From Inside GitHub Actions"><meta name=twitter:description content="A little experiment in using GitHub Copilot REST APIs inside GitHub Actions to avoid manually parsing text bodies."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Writing","name":"Using GitHub Copilot From Inside GitHub Actions","headline":"Using GitHub Copilot From Inside GitHub Actions","description":"A little experiment in using GitHub Copilot REST APIs inside GitHub Actions to avoid manually parsing text bodies.","abstract":"A little experiment in using GitHub Copilot REST APIs inside GitHub Actions to avoid manually parsing text bodies.","url":"https:\/\/den.dev\/blog\/github-copilot-inside-github-actions\/","author":{"@type":"Person","name":"Den Delimarsky"},"copyrightYear":"2025","dateCreated":"2025-01-25T00:00:00\u002b00:00","datePublished":"2025-01-25T00:00:00\u002b00:00","dateModified":"2025-01-25T00:00:00\u002b00:00","keywords":["github","ai","copilot","api","reverse-engineering"],"mainEntityOfPage":"true","wordCount":"4213"}]</script><meta name=author content="Den Delimarsky"><link href=https://www.linkedin.com/in/dendeli/ rel=me><link href=https://www.youtube.com/@DenDev rel=me><link href=https://github.com/dend rel=me><link href=https://bsky.app/profile/den.dev rel=me><link href=https://mastodon.social/@localden rel=me><script defer type=text/javascript src=/js/mermaid.bundle.627873b740aebd4e1fbfc4e9972b166b61739a4b61bc719ddff3c42a06302a92b3bf5375a03cd79ef12e68e2ad72bcb0b7a229f8a909cf823515aaa69bf8073a.js integrity="sha512-Ynhzt0CuvU4fv8TplysWa2FzmkthvHGd3/PEKgYwKpKzv1N1oDzXnvEuaOKtcrywt6Ip+KkJz4I1Faqmm/gHOg=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Den Delimarsky</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/blog/ rel=me title=Writing><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/about/ rel=me title=About><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">About</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=https://theworkitem.com rel=me title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Podcast</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=https://bsky.app/profile/den.dev rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530"><path d="m135.72 44.03C202.216 93.951 273.74 195.17 3e2 249.49c26.262-54.316 97.782-155.54 164.28-205.46C512.26 8.009 590-19.862 590 68.825c0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-.0174-2.9357-1.1937.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07.0-88.687 77.742-60.816 125.72-24.795z" fill="currentcolor"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=https://www.linkedin.com/in/dendeli/ rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href="https://www.youtube.com/channel/UCNHIUc6KE64sUe5G0eP70aQ?sub_confirmation=1" rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=https://mastodon.social/@localden rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=https://github.com/dend rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/index.xml rel=me title target=_blank><span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M64 32C28.7 32 0 60.7.0 96V416c0 35.3 28.7 64 64 64H384c35.3.0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24 137 0 248 111 248 248 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-2e2-2e2-2e2-13.3.0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24 83.9.0 152 68.1 152 152 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104-13.3.0-24-10.7-24-24zm0 120a32 32 0 1164 0 32 32 0 11-64 0z"/></svg></span></span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button-1 title="Search (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Hi, I'm Den ðŸ‘‹</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/blog/>Writing</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/blog/github-copilot-inside-github-actions/>Using GitHub Copilot From Inside GitHub Actions</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Using GitHub Copilot From Inside GitHub Actions</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2025-01-25 00:00:00 +0000 UTC">January 25, 2025</time><span class="px-2 text-primary-500">&#183;</span><span>4213 words</span></div><div class="my-1 text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/tags/github/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">github</a>
<a href=/tags/ai/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">ai</a>
<a href=/tags/copilot/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">copilot</a>
<a href=/tags/api/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">api</a>
<a href=/tags/reverse-engineering/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">reverse-engineering</a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#exploring-the-fundamentals-of-the-github-copilot-api>Exploring the fundamentals of the GitHub Copilot API</a><ul><li><a href=#endpoints>Endpoints</a></li></ul></li><li><a href=#stitching-it-all-together-in-a-python-script>Stitching it all together in a Python script</a></li><li><a href=#using-the-script-from-github-actions>Using the script from GitHub Actions</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose grow"><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 ltr:pr-3 rtl:pl-3"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg></span></span><span class=dark:text-neutral-300><strong>Warning!</strong> This blog post explores a fun and lightweight approach of using GitHub Copilot inside GitHub Actions through <strong>undocumented APIs</strong>. This was done in my free time as a prototype/thought exercise and <strong>is not intended for use in production</strong> for a myriad of real reasons, such as &ldquo;This can break at any point.&rdquo; Read this as entertainment more so than a guideline of how to implement this pattern for serious projects.</span></div><p>I enjoy using GitHub Copilot not the least because it <em>really</em> helps me automate the boring and more repetitive tasks fairly easily, and I am big on saving my time <em>not</em> doing boring and repetitive tasks.</p><p>A problem bubbled up in my <a href=https://github.com/blogscroll/blogscroll/issues target=_blank rel="noreferrer noopener">BlogScroll project</a> - people submit their website entries in a structured way, but then I have to go and manually add them to the category list that they picked <em>if</em> the website is approved. A submission may look like this:</p><figure><a href=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/example-blogscroll-submission.webp><img class="mx-auto my-0 rounded-md" alt="Example of a BlogScroll submission in the GitHub repository." src=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/example-blogscroll-submission.webp></a><figcaption class=text-center>Example of a BlogScroll submission in the GitHub repository.</figcaption></figure><p>I could tackle this problem in two ways - manually reading the issue, inspecting the page, and then creating a pull request, or go the route of using regular expressions to parse out the body of the issue, and then create a pull request. The latter sounds way more robust, but I thought I&rsquo;d have some fun and see if I can plug GitHub Copilot to do this for me without me writing custom RegEx.</p><div class="flex flex-row items-center px-4 py-2 mb-8 text-base rounded-md bg-primary-100 dark:bg-primary-900"><div style=width:25%><img src=https://assets.den.dev/images/shared/thinking.gif alt="Mole out of the ground, thinking."></div><div style=padding:8px;max-width:75%><p>But why use GitHub Copilot with undocumented APIs when you could <i>probably</i> use any other large language model (LLM) that has an available and documented public API? <a href=https://azure.microsoft.com/products/ai-services/openai-service>Azure OpenAI</a> comes to mind as a service to use here!</p></div></div><p>GitHub Copilot has one <strong>amazing</strong> differentiator - the ability to carry the <em>context</em> of GitHub items I am dealing with. For example, if I am working <em>within a repository</em> I can very easily provide that repository as <em>context</em> for my prompt, making it possible to structure the output based on the knowledge within that repository. The same benefit is also applicable to issues, and because that&rsquo;s exactly what I am dealing with for BlogScroll, I thought it&rsquo;s the best way for me to leverage LLM capabilities without reinventing the wheel and providing extensive information/detailed prompts to another API.</p><h2 id=exploring-the-fundamentals-of-the-github-copilot-api class="relative group">Exploring the fundamentals of the GitHub Copilot API <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#exploring-the-fundamentals-of-the-github-copilot-api aria-label=Anchor>#</a></span></h2><p>One of the interesting things about GitHub Copilot is that <strong>it doesn&rsquo;t yet have a public API</strong>, but because I already like to <a href=https://den.dev/tags/halo-api target=_blank rel="noreferrer noopener">tinker with various APIs</a>, I knew just the tool I needed to inspect the traffic as I was playing around with prompts in the GitHub Copilot web interface - <a href=https://www.telerik.com/fiddler/fiddler-classic target=_blank rel="noreferrer noopener">Fiddler</a>. I noticed the following endpoints being used:</p><ul><li>Token endpoint: <code>https://github.com/github-copilot/chat/token</code></li><li>Thread bootstrap endpoint: <code>https://api.individual.githubcopilot.com/github/chat/threads</code></li><li>Conversation endpoint: <code>https://api.individual.githubcopilot.com/github/chat/threads/{thread_id}/messages</code></li><li>Conversation management endpoint: <code>https://api.individual.githubcopilot.com/github/chat/threads/{thread_id}</code></li></ul><p>At a high level, the endpoints are used like this:</p><div class=mermaid align=center>graph TD
A[Request Token] --> B[Bootstrap New Thread]
B --> C[Submit Prompt To Thread]
C --> D[Received Streamed Response]
D --> C
D --> E[Cleanup Thread]</div><p>Let&rsquo;s talk a bit more about the endpoints themselves.</p><h3 id=endpoints class="relative group">Endpoints <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#endpoints aria-label=Anchor>#</a></span></h3><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 ltr:pr-3 rtl:pl-3"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg></span></span><span class=dark:text-neutral-300><strong>Note:</strong> To use the GitHub Copilot API endpoints below you will need to ensure that your account has access to GitHub Copilot.</span></div><h4 id=token-endpoint class="relative group">Token endpoint <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#token-endpoint aria-label=Anchor>#</a></span></h4><p>The token endpoint is used to request the <strong>GitHub Copilot API token</strong>. This is different from your typical GitHub Personal Access Token (PAT) or a standard authentication token, and is specific to the GitHub Copilot flows. To get a token, you need to <code>POST</code> a request with the following headers:</p><table><thead><tr><th style=text-align:left>Header</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left><code>Cookie</code></td><td style=text-align:left>Session ID, obtained from a local cookie. You can log in to <code>https://github.com</code> in your browser and then use the Network Inspector to grab the <code>user_session=ABCDE12345</code> part of the cookie. It&rsquo;s the only one that is needed to get a token.</td></tr><tr><td style=text-align:left><code>X-Requested-With</code></td><td style=text-align:left><code>XMLHttpRequest</code></td></tr><tr><td style=text-align:left><code>GitHub-Verified-Fetch</code></td><td style=text-align:left><code>true</code></td></tr><tr><td style=text-align:left><code>Origin</code></td><td style=text-align:left><code>https://github.com</code></td></tr></tbody></table><p>And as a reminder, the endpoint is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://github.com/github-copilot/chat/token
</span></span></span></code></pre></div><div class="flex flex-row items-center px-4 py-2 mb-8 text-base rounded-md bg-primary-100 dark:bg-primary-900"><div style=width:25%><img src=https://assets.den.dev/images/shared/stop.gif alt="Mole out of the ground, thinking."></div><div style=padding:8px;max-width:75%><p>Hold on - <strong>you're using cookies</strong> instead of a more robust OAuth approach? Wouldn't this be the worst way to go about solving the problem of minting a new API token?</p></div></div><p>Yes, this is a bit hacky to rely on a cookie, but remember what I said - <strong>none of this is for production use</strong>. It&rsquo;s just a fun experiment. Fun fact - if you use the <a href=https://cli.github.com/ target=_blank rel="noreferrer noopener">GitHub CLI</a> (<code>gh</code>), and specifically if you inspect the traffic for the <code>gh copilot</code> set of commands, you will notice that you can get a <em>different</em> kind of token for CLI-based prompts (starting with <code>gho_</code>).</p><p>In those scenarios, you can use <a href=https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/authorizing-oauth-apps#device-flow target=_blank rel="noreferrer noopener">Device Flow</a> together with the GitHub CLI client ID to get an access token that you can use with GitHub&rsquo;s Copilot API endpoints, however I have noticed that if you are not using a session-based token (that is - minted from a <code>user_session</code>), then the context for issues and the repository are completely ignored and I am getting answers that are not quite accurate. Maybe I am not looking in the right places, but because this is a &ldquo;for fun&rdquo; project, I wasn&rsquo;t too worried about the durability of my approach.</p><p>Either way once you <code>POST</code> to the endpoint above with the correct data in the headers, you should be able to get a JSON response like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;token&#34;</span><span class=p>:</span> <span class=s2>&#34;SUPER_SECRET_VALUE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;expiration&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-01-26T03: 03: 57.000Z&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The token itself is short-lived (30 minutes), but the <em>session</em> is not, so as long as you keep a <code>user_session</code> reference and haven&rsquo;t logged out from the GitHub web interface, you can continue to use it to mint new tokens as you see fit.</p><h4 id=thread-bootstrap-endpoint class="relative group">Thread bootstrap endpoint <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#thread-bootstrap-endpoint aria-label=Anchor>#</a></span></h4><p>Once you have a token, you can now bootstrap new threads (that is - new chats) with GitHub Copilot. To successfully create a new thread, you need to <code>POST</code> a request to the following endpoint:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.individual.githubcopilot.com/github/chat/threads
</span></span></span></code></pre></div><p>You will also need to make sure that you include the following headers:</p><table><thead><tr><th style=text-align:left>Header</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left><code>Authorization</code></td><td style=text-align:left><code>GitHub-Bearer {api_token}</code></td></tr><tr><td style=text-align:left><code>Content-Type</code></td><td style=text-align:left><code>application/json</code></td></tr></tbody></table><p>The <code>{api_token}</code> value is the token that you received from the <a href=#token-endpoint>token endpoint</a>. If the thread is created, you will get a response like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;thread_id&#34;</span><span class=p>:</span> <span class=s2>&#34;54c1eecf-b8f6-4e14-aabf-1f26c482220d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;thread&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;54c1eecf-b8f6-4e14-aabf-1f26c482220d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;repoID&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;repoOwnerID&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;createdAt&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-01-26T02:49:42.92162332Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;updatedAt&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-01-26T02:49:42.92162332Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;sharedAt&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;associatedRepoIDs&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>You will need the <code>thread_id</code> value to start prompting the model.</p><h4 id=conversation-endpoint class="relative group">Conversation endpoint <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conversation-endpoint aria-label=Anchor>#</a></span></h4><p>The URI for the endpoint is the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>https://api.individual.githubcopilot.com/github/chat/threads/{thread_id}/messages
</span></span></span></code></pre></div><p>The <code>{thread_id}</code> value is the GUID you obtained when you <a href=#thread-bootstrap-endpoint>bootstrapped a new thread</a>. You will also need the following headers for each request:</p><table><thead><tr><th style=text-align:left>Header</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left><code>Authorization</code></td><td style=text-align:left><code>GitHub-Bearer {api_token}</code></td></tr><tr><td style=text-align:left><code>Content-Type</code></td><td style=text-align:left><code>application/json</code></td></tr></tbody></table><p>And just like I mentioned before, the <code>{api_token}</code> value is the token that you received from the <a href=#token-endpoint>token endpoint</a>. To submit a prompt, you will need to <code>POST</code> some JSON, and not just any JSON, but a blob formatted like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;intent&#34;</span><span class=p>:</span> <span class=s2>&#34;conversation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;references&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>314958631</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ownerLogin&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ownerType&#34;</span><span class=p>:</span> <span class=s2>&#34;Organization&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;readmePath&#34;</span><span class=p>:</span> <span class=s2>&#34;README.md&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;ðŸ“œ An aggregator of independently-owned blogs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;commitOID&#34;</span><span class=p>:</span> <span class=s2>&#34;a14a4a6e8dfa2e0ddec0f66b01427db562dca971&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ref&#34;</span><span class=p>:</span> <span class=s2>&#34;refs/heads/main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;refInfo&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;branch&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;visibility&#34;</span><span class=p>:</span> <span class=s2>&#34;public&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;languages&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Python&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>48.3</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;HTML&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>31.1</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;CSS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>13.2</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Shell&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>7.4</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;customInstructions&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;repository&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;context&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>314958631</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ownerLogin&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ownerType&#34;</span><span class=p>:</span> <span class=s2>&#34;Organization&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;readmePath&#34;</span><span class=p>:</span> <span class=s2>&#34;README.md&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;ðŸ“œ An aggregator of independently-owned blogs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;commitOID&#34;</span><span class=p>:</span> <span class=s2>&#34;a14a4a6e8dfa2e0ddec0f66b01427db562dca971&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ref&#34;</span><span class=p>:</span> <span class=s2>&#34;refs/heads/main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;refInfo&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;branch&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;visibility&#34;</span><span class=p>:</span> <span class=s2>&#34;public&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;languages&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Python&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>48.3</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;HTML&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>31.1</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;CSS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>13.2</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Shell&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;percent&#34;</span><span class=p>:</span> <span class=mf>7.4</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;customInstructions&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;repository&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;currentURL&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/blogscroll/blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;streaming&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;confirmations&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;customInstructions&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;mode&#34;</span><span class=p>:</span> <span class=s2>&#34;assistive&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;parentMessageID&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;tools&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Now, the JSON can be <em>significantly</em> simpler if you omit the <code>references</code> and <code>context</code> sections - and you can <em>absolutely</em> do that. You&rsquo;ll see what I do with it below, but it&rsquo;s important that you keep these in (or modify them for the right context) if you want to prompt the model for specifics around GitHub entities (such as, in the case above, my <code>blogscroll/blogscroll</code> repository).</p><p>The <code>content</code> property is the prompt itself. When you submit the request, the data will be returned in the shape of <a href=https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events target=_blank rel="noreferrer noopener">Server-Sent Events</a> (SSE) data. The response will be <em>streamed</em> and it will look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;The&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; `&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;`&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; repository&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; is&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; an&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; open&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; directory&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; of&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; personal&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; sites&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; and&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; blogs&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;,&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; maintained&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; entirely&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; on&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; Git&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;Hub&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;.&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; It&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; was&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; created&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; by&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; Den&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; Del&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;im&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;ars&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;ky&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; to&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; bring&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; attention&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; to&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; independently&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;-owned&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; blogs&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; and&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; personal&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; websites&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;,&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; facilitating&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; their&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; discovery&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;.&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; For&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; more&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; details&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;,&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; you&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; can&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; check&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; the&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; [&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;README&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; file&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;](&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;https&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;://&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;github&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;.com&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blob&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/a&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;14&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;a&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;4&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;a&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;6&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;e&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;8&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;dfa&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;2&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;e&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;0&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;d&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;dec&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;0&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;f&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;66&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;b&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;014&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;27&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;db&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;562&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;d&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;ca&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;971&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;README&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;.md&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;)&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; and&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; the&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; [&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;repository&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34; metadata&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;](&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;https&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;://&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;github&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;.com&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;/blog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;scroll&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;content&#34;</span><span class=p>,</span><span class=nt>&#34;body&#34;</span><span class=p>:</span><span class=s2>&#34;).&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>data:</span> <span class=p>{</span><span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;complete&#34;</span><span class=p>,</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;9a0c48a1-e258-41f5-a74f-38584b59e048&#34;</span><span class=p>,</span><span class=nt>&#34;parentMessageID&#34;</span><span class=p>:</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=nt>&#34;turnId&#34;</span><span class=p>:</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=nt>&#34;createdAt&#34;</span><span class=p>:</span><span class=s2>&#34;2025-01-26T03:02:34.621459216Z&#34;</span><span class=p>,</span><span class=nt>&#34;references&#34;</span><span class=p>:[],</span><span class=nt>&#34;role&#34;</span><span class=p>:</span><span class=s2>&#34;assistant&#34;</span><span class=p>,</span><span class=nt>&#34;intent&#34;</span><span class=p>:</span><span class=s2>&#34;conversation&#34;</span><span class=p>,</span><span class=nt>&#34;copilotAnnotations&#34;</span><span class=p>:{</span><span class=nt>&#34;CodeVulnerability&#34;</span><span class=p>:[],</span><span class=nt>&#34;PublicCodeReference&#34;</span><span class=p>:[]}}</span>
</span></span></code></pre></div><p>You can parse the data out and concatenate it into one string from all the <code>content</code> pieces, but on that shortly.</p><h4 id=conversation-management-endpoint class="relative group">Conversation management endpoint <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conversation-management-endpoint aria-label=Anchor>#</a></span></h4><p>The last, but not least important endpoint, is the one we can use to <em>cleanup</em> existing conversations (identified by <code>thread_id</code>). The endpoint is:</p><pre tabindex=0><code>https://api.individual.githubcopilot.com/github/chat/threads/{thread_id}
</code></pre><p>You probably already suspect what headers will be needed:</p><table><thead><tr><th style=text-align:left>Header</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left><code>Authorization</code></td><td style=text-align:left><code>GitHub-Bearer {api_token}</code></td></tr><tr><td style=text-align:left><code>Content-Type</code></td><td style=text-align:left><code>application/json</code></td></tr></tbody></table><p>If you send a <code>DELETE</code> request to this endpoint, the conversation will be erased. You will see why this is needed in the following section.</p><h2 id=stitching-it-all-together-in-a-python-script class="relative group">Stitching it all together in a Python script <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#stitching-it-all-together-in-a-python-script aria-label=Anchor>#</a></span></h2><p>Now that you&rsquo;re familiar with the endpoints, it&rsquo;s time to get back to the problem I started this post with:</p><ol><li>I have <a href=https://github.com/blogscroll/blogscroll/issues target=_blank rel="noreferrer noopener">BlogScroll submissions</a>.</li><li>For each submission, I want to be able to extract the data in a TOML format (similar to how I already have it in <a href=https://github.com/blogscroll/blogscroll/blob/main/web/data/categories/technology/list.toml target=_blank rel="noreferrer noopener">some files</a>).</li><li>I then use that TOML blob as a new entry for the category-specific file that someone chose for their site.</li></ol><p>Oh yes, and for each issue I know that I can provide the <em>context</em> to GitHub Copilot, that will ensure that the AI model looks <em>just at that specific issue</em> and is not hallucinating a response. Let&rsquo;s take a look at my <em>full</em> script (you can also see it <a href=https://github.com/blogscroll/blogscroll/blob/main/util/copilot-automation/__main__.py target=_blank rel="noreferrer noopener">on GitHub</a>) that gets the data out with the help of GitHub Copilot APIs:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sseclient</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_args</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Parse and return command-line arguments.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&#34;Automate BlogScroll entry identification with GitHub Copilot.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--session-id&#34;</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;The session ID to use.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--issue-id&#34;</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;Issue ID (not number) for which context extraction is happening.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--issue-number&#34;</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;Issue number for which context extraction is happening.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_api_token</span><span class=p>(</span><span class=n>session_id</span><span class=p>,</span> <span class=n>token_url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Fetch the API token using the provided session ID.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Cookie&#39;</span><span class=p>:</span> <span class=n>session_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;X-Requested-With&#39;</span><span class=p>:</span> <span class=s1>&#39;XMLHttpRequest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;GitHub-Verified-Fetch&#39;</span><span class=p>:</span> <span class=s1>&#39;true&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Origin&#39;</span><span class=p>:</span> <span class=s1>&#39;https://github.com&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>token_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>201</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch API token. Status code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>, Response: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bootstrap_thread</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>bootstrap_url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Initialize a conversation thread and return the thread state.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Authorization&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;GitHub-Bearer </span><span class=si>{</span><span class=n>api_token</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>bootstrap_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>201</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to bootstrap thread. Status code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>, Response: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_json_prompt</span><span class=p>(</span><span class=n>issue_number</span><span class=p>,</span> <span class=n>issue_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Build the JSON prompt for the thread conversation.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Use this file as a general reference for TOML format that I want you to use: web/data/categories/technology/list.toml in the blogscroll/blogscroll repository. DO NOT USE THIS CONTENT IN THE RESPONSE. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;If your response includes ANY content from this file, it will be considered incorrect. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;From the current issue body, generate a TOML blob that can be inserted into the file defined as the category property. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;If the generated TOML does not represent the CURRENT ISSUE BODY, it will be considered incorrect. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;The result ID (in square brackets) should always be in the form [blog.] where what follows after the period is the site domain part from the Site URL section without the protocol, and the periods are omitted entirely. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Just in the TOML header (between square brackets) that represents the site there could be only alphanumeric characters. No hyphens, underscores, or any other special characters. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;The [blog.] part should be in lowercase and ALWAYS there. The period separating it from the rest should ALWAYS be there. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;The domain part after &#39;blog.&#39; should be in lowercase and always there. Make sure to letters are missing, even if they are duplicated. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Include the file path where the blob needs to be inserted. The file path is of the pattern web/data/categories/REPLACE-CATEGORY-HERE/list.toml. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;The REPLACE-CATEGORY-HERE should match 1:1 the category that is provided in the issue body, in the Site category section.&#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;The TOML content should NOT contain any properties other than name, url, and favicon. If other properties are present, the results will be considered incorrect. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Return data in JSON format (just the JSON). JSON response should have two properties - `content` for the TOML content, and `file_path` for the file path.&#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;UNDER NO CIRCUMSTANCES in the response you produce should you include Markdown markers (```) that delineate the code fragment.&#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Just return the raw JSON without the triple ticks. If your response contains ```, it will be considered incorrect.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;intent&#34;</span><span class=p>:</span> <span class=s2>&#34;conversation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;context&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;issue&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>issue_id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;number&#34;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>issue_number</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;repository&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=mi>314958631</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;owner&#34;</span><span class=p>:</span> <span class=s2>&#34;blogscroll&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;currentURL&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;https://github.com/blogscroll/blogscroll/issues/</span><span class=si>{</span><span class=n>issue_number</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;streaming&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;confirmations&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;customInstructions&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;mode&#34;</span><span class=p>:</span> <span class=s2>&#34;assistive&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;parentMessageID&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tools&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_thread_responses</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>prompt</span><span class=p>,</span> <span class=n>conversation_url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Send a conversation prompt and stream responses.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Authorization&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;GitHub-Bearer </span><span class=si>{</span><span class=n>api_token</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>conversation_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>201</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to send prompt. Status code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>, Response: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>client</span> <span class=o>=</span> <span class=n>sseclient</span><span class=o>.</span><span class=n>SSEClient</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response_content</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>client</span><span class=o>.</span><span class=n>events</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;type&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=s1>&#39;content&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response_content</span> <span class=o>+=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response_content</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete_thread</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>conversation_url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Send a conversation prompt and stream responses.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Authorization&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;GitHub-Bearer </span><span class=si>{</span><span class=n>api_token</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>conversation_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>201</span><span class=p>,</span> <span class=mi>204</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to delete thread. Status code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>, Response: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>session_id</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>session_id</span>
</span></span><span class=line><span class=cl>    <span class=n>issue_id</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>issue_id</span>
</span></span><span class=line><span class=cl>    <span class=n>issue_number</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>issue_number</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>token_endpoint</span> <span class=o>=</span> <span class=s2>&#34;https://github.com/github-copilot/chat/token&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>thread_bootstrap_endpoint</span> <span class=o>=</span> <span class=s2>&#34;https://api.individual.githubcopilot.com/github/chat/threads&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>api_token</span> <span class=o>=</span> <span class=n>fetch_api_token</span><span class=p>(</span><span class=n>session_id</span><span class=p>,</span> <span class=n>token_endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>thread_state</span> <span class=o>=</span> <span class=n>bootstrap_thread</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>thread_bootstrap_endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>thread_id</span> <span class=o>=</span> <span class=n>thread_state</span><span class=p>[</span><span class=s1>&#39;thread_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>json_prompt</span> <span class=o>=</span> <span class=n>build_json_prompt</span><span class=p>(</span><span class=n>issue_id</span><span class=o>=</span><span class=n>issue_id</span><span class=p>,</span> <span class=n>issue_number</span><span class=o>=</span><span class=n>issue_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>thread_conversation_endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;https://api.individual.githubcopilot.com/github/chat/threads/</span><span class=si>{</span><span class=n>thread_id</span><span class=si>}</span><span class=s2>/messages&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response_content</span> <span class=o>=</span> <span class=n>fetch_thread_responses</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>json_prompt</span><span class=p>,</span> <span class=n>thread_conversation_endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>response_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>thread_conversation_endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;https://api.individual.githubcopilot.com/github/chat/threads/</span><span class=si>{</span><span class=n>thread_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>thread_deleted</span> <span class=o>=</span> <span class=n>delete_thread</span><span class=p>(</span><span class=n>api_token</span><span class=p>,</span> <span class=n>thread_conversation_endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><p>This seems like a lot, but it&rsquo;s a lot less scary if I tell you that the <em>bulk</em> of it is just wrapping the endpoints I mentioned above:</p><ul><li><code>get_args</code> is responsible for getting command line arguments from the terminal. We need three of them:<ul><li><code>--session-id</code> - the value of the session cookie.</li><li><code>--issue-id</code> - unique issue ID (not the number - the ID) for the new BlogScroll website submission.</li><li><code>--issue-number</code> - unique issue number (this is what you see in the GitHub UI).</li></ul></li><li><code>fetch_api_token</code> is responsible for <a href=#token-endpoint>minting a new API token</a> based on the session details.</li><li><code>bootstrap_thread</code> creates <a href=#thread-bootstrap-endpoint>a new thread</a>.</li><li><code>build_json_prompt</code> constructs the JSON structure for the prompt we&rsquo;re submitting to GitHub Copilot. This includes detailed instructions on how to read the data from the issue body and then structure the response.</li><li><code>fetch_thread_responses</code> will <a href=#conversation-endpoint>stream the response</a> from the GitHub Copilot API when provided a prompt. I use the <a href=https://pypi.org/project/sseclient-py/ target=_blank rel="noreferrer noopener"><code>sseclient-py</code></a> library to get the SSE response and combine the pieces in one final string.</li><li><code>delete_thread</code> will <a href=#conversation-management-endpoint>cleanup the thread from the history</a>, because we don&rsquo;t need ephemeral threads to pollute the web UI.</li></ul><p>You might also notice that there are a few values in my prompt that are hardcoded and others that are dynamic. Repository metadata is hardcoded, because I only plan to run this script within one repository - <code>blogscroll/blogscroll</code>. The issue data, in turn, is dynamic, and is inserted from the command line arguments provided when the script is executed. You will see soon how that&rsquo;s used from within GitHub Actions.</p><p>I also alluded to the fact that I wanted to clean up the conversation after execution. If that&rsquo;s not done, you end up with, well, this:</p><figure><a href=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/many-threads-copilot.webp><img class="mx-auto my-0 rounded-md" alt="Many new conversations in the GitHub Copilot web UI." src=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/many-threads-copilot.webp></a><figcaption class=text-center>Many new conversations in the GitHub Copilot web UI.</figcaption></figure><p>Not ideal - I don&rsquo;t want to manually delete them later, so it&rsquo;s much easier to do it in the script.</p><p>When the script runs, the TOML data, along with the path to the file that is inferred from the category that the user provided is returned in one JSON blob:</p><figure><a href=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/run-local-script.gif><img class="mx-auto my-0 rounded-md" alt="Running local script to get a GitHub Copilot-sourced JSON blob." src=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/run-local-script.gif></a><figcaption class=text-center>Running local script to get a GitHub Copilot-sourced JSON blob.</figcaption></figure><p>Here, you can see that based on the issue metadata, GitHub Copilot successfully provided a valid JSON blob that contains all the data that I need to insert it into an existing blog scroll list file.</p><h2 id=using-the-script-from-github-actions class="relative group">Using the script from GitHub Actions <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#using-the-script-from-github-actions aria-label=Anchor>#</a></span></h2><p>Next, I needed to make sure that I am actually capable of invoking the script from a GitHub Action. I decided that the trigger for that should be me submitting an <code>/approved</code> comment to an issue. In turn, that action should:</p><ol><li>Label the issue as <code>approved</code> and remove the <code>needs-triage</code> label.</li><li>Run the <code>copilot-automation</code> script from above and get the JSON blob.</li><li>Based on the JSON blob, determine the file that needs to be updated, and add the TOML blob to it.</li><li>Commit the change to an <code>automation-update</code> branch and push it to my repo.</li><li>Create a pull request, if one doesn&rsquo;t already exists.</li></ol><p>This way, I can <em>significantly</em> reduce the time I spend manually handling submissions. The action (also - <a href=https://github.com/blogscroll/blogscroll/blob/main/.github/workflows/approve.yml target=_blank rel="noreferrer noopener">source on GitHub</a>) looks like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Approve Issue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>issue_comment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>types</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>created]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>approve</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check comment author and content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>check_comment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            if (context.payload.comment.user.login === &#39;dend&#39; &amp;&amp; context.payload.comment.body.trim() === &#39;/approved&#39;) {
</span></span></span><span class=line><span class=cl><span class=sd>              core.setOutput(&#39;approved&#39;, &#39;true&#39;);
</span></span></span><span class=line><span class=cl><span class=sd>            } else {
</span></span></span><span class=line><span class=cl><span class=sd>              core.setOutput(&#39;approved&#39;, &#39;false&#39;);
</span></span></span><span class=line><span class=cl><span class=sd>            }</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Remove &#39;needs-triage&#39; label and add &#39;approved&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const issueLabels = await github.rest.issues.listLabelsOnIssue({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              issue_number: context.issue.number
</span></span></span><span class=line><span class=cl><span class=sd>            });
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const labels = issueLabels.data.map(label =&gt; label.name);
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            if (labels.includes(&#39;needs-triage&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sd>              await github.rest.issues.removeLabel({
</span></span></span><span class=line><span class=cl><span class=sd>                owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>                repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>                issue_number: context.issue.number,
</span></span></span><span class=line><span class=cl><span class=sd>                name: &#39;needs-triage&#39;
</span></span></span><span class=line><span class=cl><span class=sd>              });
</span></span></span><span class=line><span class=cl><span class=sd>            }
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            if (!labels.includes(&#39;approved&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sd>              await github.rest.issues.addLabels({
</span></span></span><span class=line><span class=cl><span class=sd>                owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>                repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>                issue_number: context.issue.number,
</span></span></span><span class=line><span class=cl><span class=sd>                labels: [&#39;approved&#39;]
</span></span></span><span class=line><span class=cl><span class=sd>              });
</span></span></span><span class=line><span class=cl><span class=sd>            }</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>GITHUB_TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.GITHUB_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up Python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-python@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>python-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.x&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>working-directory</span><span class=p>:</span><span class=w> </span><span class=l>util</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          python -m pip install --upgrade pip
</span></span></span><span class=line><span class=cl><span class=sd>          pip install -r requirements.txt</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check issue number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;Issue number: ${{ github.event.issue.number }}&#34;</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Get issue ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>get_issue_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const issue = await github.rest.issues.get({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              issue_number: context.issue.number
</span></span></span><span class=line><span class=cl><span class=sd>            });
</span></span></span><span class=line><span class=cl><span class=sd>            core.setOutput(&#39;issue_id&#39;, issue.data.id);</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Echo issue ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;Issue ID: ${{ steps.get_issue_id.outputs.issue_id }}&#34;</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run copilot-automation script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>run_copilot_automation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          set -e  # Exit on error
</span></span></span><span class=line><span class=cl><span class=sd>          output=$(python -m copilot-automation \
</span></span></span><span class=line><span class=cl><span class=sd>            --session-id &#34;${{ secrets.SESSION_ID }}&#34; \
</span></span></span><span class=line><span class=cl><span class=sd>            --issue-number &#34;${{ github.event.issue.number }}&#34; \
</span></span></span><span class=line><span class=cl><span class=sd>            --issue-id &#34;${{ steps.get_issue_id.outputs.issue_id }}&#34;)
</span></span></span><span class=line><span class=cl><span class=sd>          
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;Raw output:&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;$output&#34;
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          # Escape the JSON output for GITHUB_OUTPUT
</span></span></span><span class=line><span class=cl><span class=sd>          escaped_output=$(echo &#34;$output&#34; | jq -c .)
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;issue_json=$escaped_output&#34; &gt;&gt; $GITHUB_OUTPUT</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>working-directory</span><span class=p>:</span><span class=w> </span><span class=l>util</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Create and switch to new branch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          git fetch origin
</span></span></span><span class=line><span class=cl><span class=sd>          if git show-ref --quiet refs/remotes/origin/automation-update; then
</span></span></span><span class=line><span class=cl><span class=sd>            git checkout automation-update
</span></span></span><span class=line><span class=cl><span class=sd>            git pull origin automation-update
</span></span></span><span class=line><span class=cl><span class=sd>          else
</span></span></span><span class=line><span class=cl><span class=sd>            git checkout -b automation-update
</span></span></span><span class=line><span class=cl><span class=sd>          fi</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check for TOML content and update file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          issue_json=&#39;${{ steps.run_copilot_automation.outputs.issue_json }}&#39;
</span></span></span><span class=line><span class=cl><span class=sd>          issue_number=&#39;${{ github.event.issue.number }}&#39;
</span></span></span><span class=line><span class=cl><span class=sd>          ./util/update_toml.sh &#34;$issue_json&#34; &#34;$issue_number&#34;</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Commit changes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          issue_number=${{ github.event.issue.number }}
</span></span></span><span class=line><span class=cl><span class=sd>          git config --global user.name &#34;github-actions[bot]&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          git config --global user.email &#34;github-actions[bot]@users.noreply.github.com&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          git add .
</span></span></span><span class=line><span class=cl><span class=sd>          git commit -m &#34;Fixes #${issue_number}&#34;</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Push changes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          git push --set-upstream origin automation-update</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check for existing pull request</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>check_pr</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const prs = await github.rest.pulls.list({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              head: `${context.repo.owner}:automation-update`,
</span></span></span><span class=line><span class=cl><span class=sd>              base: &#39;main&#39;,
</span></span></span><span class=line><span class=cl><span class=sd>              state: &#39;open&#39;
</span></span></span><span class=line><span class=cl><span class=sd>            });
</span></span></span><span class=line><span class=cl><span class=sd>            if (prs.data.length &gt; 0) {
</span></span></span><span class=line><span class=cl><span class=sd>              core.setOutput(&#39;pr_exists&#39;, &#39;true&#39;);
</span></span></span><span class=line><span class=cl><span class=sd>              core.setOutput(&#39;pr_id&#39;, prs.data[0].number);
</span></span></span><span class=line><span class=cl><span class=sd>            } else {
</span></span></span><span class=line><span class=cl><span class=sd>              core.setOutput(&#39;pr_exists&#39;, &#39;false&#39;);
</span></span></span><span class=line><span class=cl><span class=sd>            }</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Create pull request</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39; &amp;&amp; steps.check_pr.outputs.pr_exists == &#39;false&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>create_pr</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const pr = await github.rest.pulls.create({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              title: `Automatic fixes based on approvals`,
</span></span></span><span class=line><span class=cl><span class=sd>              head: &#39;automation-update&#39;,
</span></span></span><span class=line><span class=cl><span class=sd>              base: &#39;main&#39;,
</span></span></span><span class=line><span class=cl><span class=sd>              body: &#39;This PR adds websites that were approved in the BlogScroll issue tracker.&#39;
</span></span></span><span class=line><span class=cl><span class=sd>            });
</span></span></span><span class=line><span class=cl><span class=sd>            const fs = require(&#39;fs&#39;);
</span></span></span><span class=line><span class=cl><span class=sd>            fs.appendFileSync(process.env.GITHUB_OUTPUT, `pr_id=${pr.data.number}\n`);</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Post comment on issue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.check_comment.outputs.approved == &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/github-script@v6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            const commit = await github.rest.repos.listCommits({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              sha: &#39;automation-update&#39;,
</span></span></span><span class=line><span class=cl><span class=sd>              per_page: 1
</span></span></span><span class=line><span class=cl><span class=sd>            });
</span></span></span><span class=line><span class=cl><span class=sd>            const commit_id = commit.data[0].sha;
</span></span></span><span class=line><span class=cl><span class=sd>            const pr_id = &#39;${{ steps.check_pr.outputs.pr_exists }}&#39; === &#39;true&#39; ? &#39;${{ steps.check_pr.outputs.pr_id }}&#39; : &#39;${{ steps.create_pr.outputs.pr_id }}&#39;;
</span></span></span><span class=line><span class=cl><span class=sd>            await github.rest.issues.createComment({
</span></span></span><span class=line><span class=cl><span class=sd>              owner: context.repo.owner,
</span></span></span><span class=line><span class=cl><span class=sd>              repo: context.repo.repo,
</span></span></span><span class=line><span class=cl><span class=sd>              issue_number: context.issue.number,
</span></span></span><span class=line><span class=cl><span class=sd>              body: `Commit was created to fix #${context.issue.number}: ${commit_id}. You can track the change propagation in #${pr_id}`
</span></span></span><span class=line><span class=cl><span class=sd>            });</span><span class=w>            
</span></span></span></code></pre></div><p>Once again - a <em>scary</em> bunch of YAML, but at its core it&rsquo;s not super complicated. Let&rsquo;s walk through it.</p><ol><li>Check out the repository.</li><li><strong>Check comment author and content</strong> - this step ensures that the comment is <code>/approved</code> and the author is me (<code>dend</code>). If that is the case, set <code>approved</code> to <code>true</code>. Otherwise, set it to <code>false</code>. This will be used in all subsequent steps.</li><li><strong>Remove <code>needs-triage</code> label and add <code>approved</code></strong>- checks to make sure that the labels are not already applied, and adjusts as needed.</li><li><strong>Set up Python</strong>- installs Python 3 on the runner.</li><li><strong>Install dependencies</strong> - installs the packages in <a href=https://github.com/blogscroll/blogscroll/blob/main/util/requirements.txt target=_blank rel="noreferrer noopener"><code>requirements.txt</code></a> that are needed for my <code>copilot-automation</code> Python script.</li><li><strong>Check issue number</strong> - prints the issue number. Used for debugging purposes, mostly.</li><li><strong>Get issue ID</strong> - gets the underlying issue ID (not the number) that I will need for my <code>copilot-automation</code> script.</li><li><strong>Echo issue ID</strong> - prints the issue ID. Also used for debugging purposes.</li><li><strong>Run copilot-automation script</strong> - run the Python script and get the JSON blob representing the data from the issue.</li><li><strong>Create and switch to new branch</strong> - make sure that we&rsquo;re operating on a new or existing <code>automation-update</code> branch.</li><li><strong>Check for TOML content and update file</strong> - uses a <a href=https://github.com/blogscroll/blogscroll/blob/main/util/update_toml.sh target=_blank rel="noreferrer noopener">shell script I put together</a> that updates the TOML file with new content or amends it if the issue was already covered before. This is done with the help of TOML comments that clearly identify which site is coming from which issue.</li><li><strong>Commit changes</strong> - commits the changes with the help of <code>git</code>.</li><li><strong>Push changes</strong> - pushes the changes to the repository.</li><li><strong>Check for existing pull request</strong> - checks if a pull request from <code>automation-update</code> to <code>main</code> already exists.</li><li><strong>Create pull request</strong> - creates a new pull request if one doesn&rsquo;t exist.</li><li><strong>Post comment on issue</strong> - posts a comment within the issue that tells the submitter where they can find their new site entry.</li></ol><p>And as an additional piece of configuration, I created a <code>SESSION_ID</code> secret in my repository that is used with the Python script inside GitHub Actions. This way I won&rsquo;t have to hardcode it in the script itself and risk exposure.</p><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 ltr:pr-3 rtl:pl-3"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg></span></span><span class=dark:text-neutral-300><strong>Warning!</strong> Leaking of your session cookie is equivalent to leaking of your credentials. Make sure that it is secure and you do not share it or store it anywhere in the open.</span></div><p>Whew, that was <em>a lot</em>. But, let&rsquo;s see this in action.</p><video width=100% controls>
<source src=https://assets.den.dev/images/postmedia/github-copilot-inside-github-actions/running-action-gh.mp4 type=video/mp4>Your browser does not support the video tag.</video><p>Not bad! I now saved myself countless hours of doing manual things, as well as a few hours of writing of regular expressions - all because GitHub Copilot can successfully use the context of the issue I am working on and providing output in the exact format I am requesting.</p><h2 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>While I, of course, can and will never recommend using undocumented APIs in any production workloads, this was a fun experiment and I am happy that GitHub Copilot actually provides the expected output in <em>all of the test cases</em> I had. It took some prompt fine-tuning, but ultimately I landed on one (you can see it in my script above) that gets the job done consistently.</p><p>If you would like to try GitHub Copilot, you can <a href=https://docs.github.com/en/copilot/managing-copilot/managing-copilot-as-an-individual-subscriber/about-github-copilot-free target=_blank rel="noreferrer noopener">get it for free</a> (2,000 completions per month, 50 chat messages per month). When ready, you can easily <a href=https://docs.github.com/en/copilot/setting-up-github-copilot/setting-up-github-copilot-for-yourself#1-get-access-to-github-copilot target=_blank rel="noreferrer noopener">upgrade to GitHub Copilot Pro</a>.</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=dend/blog-comments issue-term=pathname label=comment theme=photon-dark crossorigin=anonymous async></script><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/blog/hello-developer-division/><span class="mr-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-2 text-neutral-700 transition-transform group-hover:translate-x-[2px] group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Hello, Developer Division</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2025-01-23 00:00:00 +0000 UTC">January 23, 2025</time></span></span></a></span>
<span><a class="group flex text-right" href=/blog/github-copilot-vision-extension/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">A Simple Way GitHub Copilot @vision Helped Me Be More Productive</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2025-02-05 00:00:00 +0000 UTC">February 5, 2025</time></span></span>
<span class="ml-2 text-neutral-700 transition-transform group-hover:translate-x-[2px] group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 group ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/how-i-work/ title="Work Style"><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Work Style</span></a></li><li class="mb-1 group ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/archives/ title=Archives><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Archives</span></a></li></ul></nav><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">Copyright Â© 2025 Den Delimarsky. All rights reserved. Built with â˜• and ðŸ© for a global audience.</p></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://den.dev><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>